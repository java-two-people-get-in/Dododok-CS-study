# DNS
![image](https://github.com/user-attachments/assets/15b19acb-397f-4dbe-956b-817939b0a06d)

<br>

## DNS(Domain Name System)란?

DNS는 인터넷에서 사용되는 네트워크 서비스로, 사람이 이해하기 쉬운 도메인 이름(예: [www.example.com](http://www.example.com/))과 컴퓨터가 이해하는 IP 주소(예: 192.0.2.1)를 매핑하는 시스템이다.

[역할] 사용자가 도메인 이름을 입력하면 해당 도메인 이름에 대응하는 IP 주소를 찾아줌

![image](https://github.com/user-attachments/assets/6c3e566a-8781-4834-9f27-a1446b700bfa)

- IP 주소는 일련의 숫자로 이루어져 있어서 사람이 기억하고 입력하기 어려움 <br>
  → 따라서 도메인 이름을 사용
- 전세계적으로 약속된 규칙을 공유
    - 상위 기관에서 인증된 기관에게 도메인을 생성하거나 IP 주소로 변경할 수 있는 ‘권한’을 부여한다.
- DNS는 이처럼 상위 기관과 하위 기관과 같은 ‘**계층 구조**’를 가지는 **분산 데이터베이스 구조**를 가진다.

<br><br>

## DNS 구성요소

DNS는 아래 세가지 요소로 구성되어있다.

1. 도메인 네임 스페이스(Domain Name Space)
    - 도메인 이름 저장을 분산하는 방법(규칙)
2. 네임 서버(Name Server) = 권한 있는 DNS 서버
    - 해당 도메인 이름의 IP 주소를 찾음
    - DNS 서버와 같은 말
        - 근데, 리졸버 서버 등 시스템 안에서 다른 역할을 하는 서버도 있기에 그냥 DNS 서버라고 하는 것보다 네임 서버라고 하는게 더 의미가 전달된다.
3. 리졸버(Resolver) = 권한 없는 DNS 서버
    - DNS 클라이언트 요청을 네임 서버로 전달하고 찾은 정보를 클라이언트에게 제공하는 기능을 수행
    - 단말에 구현하는 것은 어려워 보통은 리졸버가 구현된 네임 서버의 IP 주소만을 파악한다.

![image](https://github.com/user-attachments/assets/2c3e9429-58ae-40f7-89f1-091a9a726196)

<br><br>

## 왜일까?

> 도메인을 계층적으로 관리해 **서버를 분리**하는 이유
> 

“이 도메인 좀 IP 주소로 바꿔줄래?”라고 할 수 있는 서버(네임서버)가 한 대만 있지 않기 때문이다.

→ 하나의 DNS 서버에서 전 세계의 모든 DNS 정보를 관리한다면..?🤯🤯🤯

*그렇다면 여러 서버(네임서버)를 만들면 되지 않을까?*

→ 그렇게 되면 해당 정보(도메인과 IP 주소)를 모든 서버에서 공유해야 함… 안그러면 어떤 서버(네임서버)에서는 ‘[www.kusitms.com](https://www.kusitms.com/)’의 IP 주소를 모른다고 할 수도 있다.

그래서 도메인을 계층적으로 구분하는, 정보(도메인과 IP주소)를 분산하는 구조를 선택하게 되었다. 그래서 도메인에 닷(dot), 점이 있는 것이다. **점이 계층을 나타낸다!**

<br><br>

## **DNS 동작 방식 설명**

> DNS 동작 방식은 아래와 같은 아이디어로 구현되었다.

웹 브라우저는 해결사 서버에게 요청한다. <br>
    ◦ “www.kusitms.kr의 IP 주소를 알려주세요.”

해결사 서버는 최상위 기관에서 관리하는 네임 서버에게 요청한다.  <br>
    ◦ ”.kr 이라는 도메인 있나요?”

최상위 기관에서 관리하는 네임 서버는 응답한다. <br>
    ◦ “.kr 한국 국가 도메인 입니다. .kr 네임 서버로 가보세요~”

해결사 서버는 이제는 .kr 네임 서버에게 요청한다. <br>
    ◦ “kusitms.kr 있나요?”

.kr 네임 서버는 응답한다. <br>
    ◦ “네 가비아로 가세요~”
    ◦ (”kusitms.kr 있나요?” 라고 물어봐도 “네 가비아로 가세요~”라고 응답한다.)

해결사 서버는 가비아 네임 서버에게 요청한다. <br>
    ◦ “www.kusitms.kr 있나요?”

가비아 네임 서버는 응답한다. <br>
    ◦ 네 12.345.678.900 으로 가세요!” 해결사 서버는 웹 브라우저에게 알려준다.
    ◦ 네 12.345.678.900 으로 가세요!”

<br><br>

## 작동방식

![image](https://github.com/user-attachments/assets/9a26c942-d7bb-49d2-b620-ebcdd8591773)

1. 사용자가 도메인 이름을 입력한다.
    - 예를 들어, 사용자가 웹 브라우저에 "www.example.com"과 같은 도메인 이름을 입력
2. 브라우저 캐시, OS 캐시, 라우터 캐시 확인
3. 로컬 DNS 캐시 확인
    - 웹 브라우저는 로컬 DNS 클라이언트 역할을 수행하여, 먼저 로컬 DNS 캐시를 확인합니다.로컬 DNS 캐시에는 최근에 이용한 도메인 이름과 해당 도메인 이름에 대응하는 IP 주소 정보가 저장되어 있습니다.이전에 동일한 도메인 이름에 접속했던 기록이 있다면 로컬 DNS 캐시에서 바로 해당 IP 주소를 찾을 수 있습니다.
4. 로컬 네트워크의 DNS 서버 질의:
    - 로컬 DNS 캐시에 해당 정보가 없는 경우, 웹 브라우저는 로컬 네트워크에 설정된 DNS 서버로 질의(Query)를 보냅니다.로컬 네트워크의 DNS 서버는 도메인 이름에 대응하는 IP 주소 정보를 가지고 있는지 확인하기 위해 다른 DNS 서버들과 질의를 주고 받음
5. 루트 DNS 서버 질의:
    - 로컬 네트워크의 DNS 서버도 해당 정보가 없는 경우, 루트 DNS 서버에 질의를 보내게 됨. 루트 DNS 서버는 인터넷의 최상위 도메인(.com, .org 등)의 DNS 서버 주소를 알려준다.
6. 중간 DNS 서버 질의:
    - 로컬 네트워크의 DNS 서버는 루트 DNS 서버로부터 얻은 최상위 도메인(.com, .org 등)의 DNS 서버에 다시 질의를 보냅니다.이 과정이 계층적으로 반복되며, 최종적으로 해당 도메인 이름에 대응하는 IP 주소를 찾음
7. IP 주소 반환:
    - DNS 서버들은 계층적으로 도메인 이름을 분석하여 최종적으로 해당 도메인 이름에 대응하는 IP 주소를 찾아 반환
8. 웹 브라우저 요청:
    - 웹 브라우저는 받은 IP 주소를 사용하여 해당 웹 서버에 요청을 보내고 웹 페이지를 받아온다.
    - 이후, 해당 도메인 이름과 IP 주소의 매핑 정보는 로컬 DNS 캐시에 저장되어 다음에 동일한 도메인에 접속할 때 빠르게 IP 주소를 찾을 수 있도록 함

<br>


***계층적 위임 구조는 호스트의 증가에 대한 관리가 효율적으로 이루어지는 것을 가능하게 한다.**

<br><br>

## **DNS 구성 요소 : 도메인 네임 스페이스(Domain Name Space)**

![image](https://github.com/user-attachments/assets/ec786f45-b6ac-4cc1-ad6d-7ee2397b72e8)

- DNS는 전세계적인 거대한 분산 시스템이다.
- 도메인 네임 스페이스는 이러한 DNS가 저장 관리하는 계층적 구조를 의미한다.
- 도메인 네임 스페이스는 최상위에 루트 DNS 서버가 존재하고 그 하위로 연결된 모든 노드가 연속해서 이어진 계층 구조로 되어있다. (폴더 구조와 비슷)

<br><br>

## **DNS 구성 요소 : 네임 서버(Name Server = DNS Server)**

문자열로 표현된 도메인 이름을 실제 컴퓨터가 통신할 때 사용하는 IP 주소로 변환시키기 위해서는 도메인 네임 스페이스의 트리 구조에 대한 정보가 필요한데 이러한 정보를 가지고 있는 서버를 네임 서버라고 한다.

1. **Root DNS 서버
    ◦** ICANN이 직접 관리하는 절대 존엄 서버이다.
    ◦ TLD DNS 서버 IP 주소를 저장하고 안내하는 역할을 한다.
2. **Top-Level Domain(TLD) DNS 서버**
    ◦ 도메인 등록 기관이 관리하는 서버이다.
    ◦ Authoritative DNS 서버의 주소를 저장하고 안내하는 역할을 한다.
    ◦ 도메인 판매 업체(가비아 등)의 DNS 설정이 변경되면 도메인 등록 기관으로 전달되기 때문에 어떤 도메인이 어떤 판매업체(가바이 등)에서 구매했는지 알수 있는 것이다.
3. **Second-Level Domain(SLD) DNS 서버 (Authoritative DNS 서버 라고도 함)**
    ◦ 실제 개인 도메인과 IP 주소의 관계가 기록(저장, 변경)되는 서버이다.
    ◦ 그래서 권한의 의미인 Authoritative가 붙었다. 일반적으로 도메인/호스팅 업체의 네임서버를 말한다.
    ◦ 개인 DNS 구축해도 이 경우에 해당한다.
4. **권한 없는 DNS 서버 (리졸버 서버, 리컬시브 서버, 리커서)**
    ◦ DNS 서버는 도메인 네임 스페이스를 위한 권한 있는 DNS 서버와 권한이 없는 DNS 서버로 구분된다.
    ◦ 위 1,2,3은 권한 있는 DNS 서버이다.
    ◦ 네임 스페이스를 위한 권한 있는 DNS 서버는 IP 주소와 도메인 이름을 매핑한다.
    ◦ 네임 스페이스를 위한 권한 없는 DNS 서버는 질의를 통해 IP 주소를 알아내거나 캐시한다.

<br><br>

### **DNS 동작 과정 전체 예시**

웹 브라우저에 www.kusitms.com을 입력한다.웹 브라우저는 이전에 방문한적 있는지 찾는다.
    ◦ 브라우저 캐시 확인
    ◦ OS 캐시 확인
    ◦ 라우터 캐시 확인
    ◦ ISP 캐시 확인 (Recursive DNS Server)
    ISP에서 DNS Iterative하게 쿼리를 날린다. ISP는 Authoritative DNS 서버에서 최종적으로 IP 주소를 응답받는다. ISP는 해당 IP 주소를 캐시한다. <br>
    웹 브라우저에게 응답한다.
