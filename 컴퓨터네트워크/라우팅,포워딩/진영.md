> 라우팅과 포워딩은 **네트워크 레이어(Network layer)** 에 반드시 있어야 하는 두 가지 기능이다. 이는 네트워크 레이어 장비인 **라우터(Router)** 가 가지고 있는 기능이기도 하다.

# 라우터
![](https://velog.velcdn.com/images/ozziny/post/2fb109f8-04f4-43ca-b8e8-6020fbf797d8/image.png)


- **route**, **forward**를 진행하는 네트워크 장치

그 중 routing이 중요.
바로 routing이 출발지에서 목적지까지 최적의 길을 routing 알고리즘을 통해 찾아주는 역할을하게 됨. 
(쉽게 말해 routing 알고리즘은 흔히 우리가 사용하는 길찾기(지도) 알고리즘이라고 생각하면 됨)


# Routing(라우팅)
- 패킷의 출발지에서 목적지까지의 경로를 결정하는 것
- **global action**
- 다양한 라우팅 알고리즘 존재

![](https://velog.velcdn.com/images/ozziny/post/6d24354d-685e-406d-a655-0c10e3c68ab7/image.png)


# Forwarding(포워딩)
- 라우터의 입력 링크부터 알맞은 라우터 출력 링크까지 패킷을 이동시키는 것
- **local action**
- switching으로 불리기도 함


패킷이 하나의 **Source**에서 **Destination**까지의 경로가 다양하게 있다.
한 경로를 선택하는 과정이 필요로 하며, Algorithm을 통해 경로를 선택하게 된다..



즉, **Routing Algorithm**을 통해 **Forwarding Table**을 만들어 진다.

한마디로,  Routing table을 만드는 과정이 데이터가 이동하는 최종 경로가 된다.

하지만, 경로에는 고장이나 속도 변화와 같은 다양한 상태들이 변경됨에 따라 경로를 갱신이 불가피해진다. 



때문에 **Forwarding Table**에는 목적지 주소에 대응하는 포트가 저장되어 있어 테이블을 참조하여 Forwarding이 이루어진다.


실제로 라우팅 알고리즘에 의해 포워딩 테이블이 만들어진다. 즉, 패킷은 라우팅 알고리즘에 의해 만들어진 포워딩 테이블을 연속적으로 참조하여 출발지에서 목적지까지 운반되어진다.

![](https://velog.velcdn.com/images/ozziny/post/bcd8e66a-9da4-49ad-94c3-5d7c001ecc08/image.png)


## 라우팅 테이블 vs 포워딩 테이블

포워딩 테이블이 라우팅테이블의 하위 개념이라고함

**라우팅 테이블** : 네트워크 경로를 결정하고, 최적의 경로를 선택하여 패킷을 전달하는 데 사용됨

**포워딩 테이블** : 실제 데이터 패킷의 포워딩을 수행합니다. 라우팅 테이블의 정보를 바탕으로 최종 포워딩 결정을 내림. 이는 라우팅 테이블의 정보를 기반으로 만들어지고 주기적으로 동기화된다.

 

다음과 같은 구성요소의 차이가 있다고 함 

### 라우팅 테이블

![](https://velog.velcdn.com/images/ozziny/post/ea2cf6e8-a82e-436a-a95b-019cb29807e0/image.png)

위와 같이 목표점, 넷마스크, 게이트웨이, 인터페이스, 메트릭으로 구성됨

![](https://velog.velcdn.com/images/ozziny/post/c195998f-faec-4b9c-b440-37933d989018/image.png)


### 포워딩 테이블
하지만 포워딩 테이블은 목표점, 인터페이스밖에 없다.

![](https://velog.velcdn.com/images/ozziny/post/d6499fde-94fc-41c7-8cd8-da9d87a53ff2/image.png)


# 라우팅 프로토콜의 종류
### 정적라우팅(Static routing)
> 관리자에 의해 Routing Table이 유지/관리 되는 기법

라우팅 테이블을 교환하지 않고 라우팅이 가능하기 때문에 네트워크 대역폭을 절약할 수 있다. 또한 외부에 자신의 경로를 알리지 않기 때문에 보안에도 강하다. 하지만 경로에 문제가 생길 경우 대처하기 어렵다는 단점이 있다.

### 동적라우팅(Dynamic routing)
> 라우팅 프로토콜에 의해 자동으로 라우팅 테이블을 구성하는 기법

자동으로 경로가 결정되는 프로토콜. 라우터가 판단하여 가장 효율적인 방법으로 패킷을 전송시키는 방법이다.

## 동적라우팅
내부라우팅(Inner Gateway Protocol)과 외부라우팅(External Gateway Protocol)로 나뉜다.

![](https://velog.velcdn.com/images/ozziny/post/58671506-5283-44a1-8b67-4f0b746c8202/image.png)

- **내부라우팅(IGP)**: 같은 AS 내부의 라우팅 정보를 교환하는 프로토콜
- **외부라우팅(EGP)**: 다른 AS 간의 라우팅 정보를 교환(다른 AS와 연결)하는 프로토콜

>💡 **AS(Autonomius System)**
AS Number(망식별번호): 각각의 자율시스템을 식별하기 위한 인터넷 상의 고유 번호
하나의 그룹/기관/회사 같이 동일한 라우팅 정책으로 하나의 관리자에 의해 운영되는 네트워크

## 동적 라우팅 알고리즘

### RIP(Routing Information Protocol)
- **최소 Hop count**를 파악하여 라우팅하는 프로토콜이다.
- 거리와 방향으로 길을 찾아가는 **Distance Vector 다이나믹 프로토콜**이다.
- 최단거리 즉, Hop count가 적은 경로를 택하여 라우팅하는 프로토콜로 Routing Table에 인접 라우터 정보를 저장하여 경로를 결정한다.
- 최대 Hop count는 15로 거리가 짧기 때문에 **IGP**로 많이 이용하는 프로토콜이다.
- 라우터의 메모리를 적게 사용하며, 30초마다 라우팅 정보를 업데이트 한다.
- Hop count가 낮을수록 좋은 경로, 소규모 네트워크에서 간편하게 구성 가능하다.
- 직접 연결되어 있는 라우터는 Hop로 계산하지 않고 **30초 주기로 default routing을 업데이트하여 인접 라우터로 정보를 전송**한다.

> 💡 **Hop Count** : 라우터를 거친 수, 라우터를 하나 거칠때마다 1씩 증가한다.


_그래서 Hop count가 15라는게 무슨말인가..?_

![](https://velog.velcdn.com/images/ozziny/post/16b866a7-966a-4036-88d5-ea9cd6077275/image.png)


### BGP(Border Gateway Protocol)
- BGP는 **외부 라우팅 프로토콜로(EGP)** AS(관리 도메인)와 AS간에 사용되는 라우팅 프로토콜이다.
- 정해진 정책에 따라 최적 라우팅 경로를 수립한다.
- **거리벡터(Distance Vector) 방식**의 라우팅 프로토콜로 다른 IGP보다 컨버전스는 느리지만 대용량의 라우팅 정보를 교환할 수 있다.
- TCP 포트 179번을 통해 인접 라우터들과 이웃(Neighbor) 관계를 성립하며, 이웃 노드 간에는 유**니캐스트 라우팅 업데이트**를 실시한다.

> 🔻 **유니캐스트 라우팅 프로토콜**
최적의 통신 경로를 찾아내는 프로토콜이다. 하나의 Sender와 하나의 Receiver 간의 통신을 의미하며 One-to-One 통신이라 하기도 한다.

### OSPF(Open Shortest Path First)
- 최단 경로 우선 프로토콜이다.
- 최저 COST(최저 시간) 경로를 최적 라우팅 경로로 결정한다.
- 가장 대표적인 **링크 상태 프로토콜**로 **최단 경로 우선(Shortest Path First)** 알고리즘으로 **다익스트라(Dijkstra) 알고리즘**을 채택해 라우팅 테이블을 생성한다.
- Area 개념을 사용하여 전체 네트워크를 작은 영역으로 나눠 효율적으로 관리한다.
- 각 Area는 Back Bone Area에 연결되어 있다.
- RIP가 30초마다 업데이트 되어 정보를 전송시키는 반면, **OSPF는 링크에 상태변화가 있을 시에 즉각적으로 Flooding**을 해주어 컨버전스 타임이 매우 빠르다.
- RIP처럼 호스트로부터 목적지까지 도달하는 비용은 근원지 라우터에서부터 목적지 네트워크까지로 계산된다.
- 관리자에 따라 각 링크는 처리량, 왕복시간, 신뢰성 등을 기반으로 가중치를 할당받을 수 있다.



### 그래서 링크 상태프로토콜이랑 거리벡터랑 뭐가 다름..?


1. **정보의 종류와 공유 방식**:
	- 경로 벡터 프로토콜: 각 라우터는 경로 리스트(AS 경로 리스트 포함)를 유지하고 공유합니다.
	- 링크 상태 프로토콜: 각 라우터는 네트워크 전체의 링크 상태 정보를 유지하고 공유합니다.

2. **경로 선택 방식**:
	- 경로 벡터 프로토콜: 정책 기반 경로 선택, 경로 리스트를 분석하여 최적 경로 선택.
	- 링크 상태 프로토콜: 다익스트라 알고리즘을 사용한 최단 경로 계산.
    
3. **루프 방지 방법**:
	- 경로 벡터 프로토콜: AS 경로 리스트를 통해 루프 방지.
	- 링크 상태 프로토콜: 네트워크 전체의 링크 상태 정보 공유를 통해 일관된 경로 계산.


#### 그래서 경로리스트랑 링크상태정보랑 뭐가 다름..?

![](https://velog.velcdn.com/images/ozziny/post/f86e81a4-ace5-4ac9-b68b-57c7476616af/image.png)


![](https://velog.velcdn.com/images/ozziny/post/39504185-caa0-4b3e-9974-0dbb753bd031/image.png)
