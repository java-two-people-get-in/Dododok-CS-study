## 네트워크 소켓(인터넷 소켓)이란?

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/68fecc62-03dd-4c1f-8237-3b6226295ac7/d3c1d419-f0f6-4e02-a835-a31565152009/Untitled.png)

네트워크 소켓은 네트워크 상에서 통신을 수행하기 위한 종단점을 의미합니다. 쉽게 말해, 소켓은 두 컴퓨터 간의 데이터 전송을 가능하게 하는 창문과 같은 역할을 한다. 

**소켓**은 소프트웨어로 작성된 추상적인 개념의 통신 접속점으로 네트웍 응용 프로그램은 소켓을 통하여 통신망으로 데이터를 송수신하게 된다. 

**소켓**은 응용 프로그램에서 TCP/IP를 이용하는 창구 역할을 하며 응용 프로그램과 소켓 사이의 **인터페이스 역할을** 하고 있습니다. 

**두 소켓이 연결되면 서로 다른 응용프로그램끼리 데이터를 전달할** 수 있게 된다.

## 소켓의 종류

네트워크 소켓에는 여러 종류가 있지만, 주로 사용되는 두 가지는 **스트림 소켓(TCP 소켓)**과 **데이터그램 소켓(UDP 소켓)**이다. 둘은 약간은 상반되는 장점과 단점을 가지고 있으며, 어떤 것을 적절하게 활용하느냐가 전체적인 서능에 큰 영향을 주게 됩니다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/68fecc62-03dd-4c1f-8237-3b6226295ac7/8dd37252-e8bc-4d96-b89f-bd47fe1125ee/Untitled.png)

### **1. 스트림 소켓 (TCP 소켓)**:

- **연결 지향적**: 스트림 소켓은 연결 지향적(점대점 통신). 이는 데이터 전송 전에 통신 경로를 설정하고, 데이터가 순서대로 전송됨을 보장한다.
- **신뢰성**: 데이터 전송의 신뢰성을 보장. 데이터가 손실되거나 손상되면 자동으로 재전송 된다.
- **사용 예**: 웹 브라우징, 이메일, 파일 전송 등 신뢰성이 중요한 애플리케이션에서 주로 사용

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/68fecc62-03dd-4c1f-8237-3b6226295ac7/fee022b0-4f96-4dfc-bbef-6587edfa7572/Untitled.png)

- **TCP 3-way Handshake 란?**

양쪽 모두 데이타를 전송할 준비가 되었다는 것을 보장하고, 실제로 데이타 전달이 시작하기전에 한쪽이 다른 쪽이 준비되었다는 것을 알게 해주는 방식

```
**Client > Server** : TCP SYN
**Server > Client** : TCP SYN ACK
**Client > Server** : TCP ACK
```

<aside>
⏬ **[STEP 1]** 
A클라이언트는 B서버에 접속을 요청하는 SYN 패킷을 보낸다. 이때 A클라이언트는 SYN 을 보내고 SYN/ACK 응답을 기다리는SYN_SENT 상태가 되는 것이다.

**[STEP 2]** 
B서버는 SYN요청을 받고 A클라이언트에게 요청을 수락한다는 ACK 와 SYN flag 가 설정된 패킷을 발송하고 A가 다시 ACK으로 응답하기를 기다린다. 이때 B서버는 SYN_RECEIVED 상태가 된다.

**[STEP 3]** 
A클라이언트는 B서버에게 ACK을 보내고 이후로부터는 연결이 이루어지고 데이터가 오가게 되는것이다. 이때의 B서버 상태가 ESTABLISHED 이다.위와 같은 방식으로 통신하는것이 신뢰성 있는 연결을 맺어 준다는 TCP의 3 Way handshake 방식

</aside>

### **2. 데이터그램 소켓 (UDP 소켓)**:

- **비연결 지향적**: 데이터그램 소켓은 비연결 지향적. 이는 데이터 전송 전에 통신 경로를 설정하지 않으며, 데이터가 순서대로 도착함을 보장하지 않는다.
- **속도**: 빠른 전송이 가능하지만 신뢰성은 떨어지게됨. 데이터가 손실되거나 손상되어도 재전송 되지 않는다.
- **점대점** 뿐만아니라 **일대다 연결도 가능**
- **사용 예**: 실시간 스트리밍, 온라인 게임, VoIP 등 속도가 중요한 애플리케이션에서 주로 사용
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/68fecc62-03dd-4c1f-8237-3b6226295ac7/25018fd6-2978-43b8-9cbe-28b538fedae9/Untitled.png)
    

### **3. RAW 소켓**:

- **저수준 네트워크 접근**:  TCP/IP 스택상의 **TCP,UDP 계층을 우회하여** 바로 어플리케이션으로 송신하는 소켓으로 RAW 소켓은 저수준의 네트워크 프로토콜에 직접 접근할 수 있게 해준다. 이를 통해 개발자는 IP 헤더를 포함한 모든 데이터를 제어할 수 있다.
- **사용 예**: 네트워크 프로토콜 구현, 패킷 스니핑, 네트워크 테스트 및 디버깅 등의 용도로 사용된다.
- **장점**: 매우 유연하며, TCP나 UDP 소켓이 제공하지 않는 기능을 사용할 수 있다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/68fecc62-03dd-4c1f-8237-3b6226295ac7/0ab33146-7413-49a0-b2aa-7a8490ee67c6/Untitled.png)

모든 데이터를 적절히 처리하거나 헤더를 제거하고 이를 파싱하는 과정을 모두 수신 **어플리케이션에서 담당해야** 합니다. 실제 **RAW소켓을** 이용하여 프로그래밍을 하는 일은 거의 드물며 만약 시스템 소프트웨어나 패킷을 분석하는 프로그램을 개발할 경우 필요할 수도 있다.

**이때 발생할 수 있는 단점은???!**

```
IP Segment에서 암호화된 악성코드가 있는 경우, IP계층에서 이를 필터링 못해 문제가 발생할 수 있다.
```

# HTTP 통신과 소켓 통신의 차이

### 1. HTTP 통신

- 클라이언트의 요청이 있을 때만 서버가 응답
- JSON, HTML, Image 등 다양한 데이터를 주고 받을 수 있음
- 서버가 응답한 후 연결을 바로 종료하는 단방향 통신이지만 Keep Alive 옵션을 주어 일정 시간동안 커넥션을 유지할 수 있다.
- 실시간 연결이 아닌 데이터 전달이 필요한 경우에만 요청을 보내는 상황에 유리

### 2. 소켓 통신

- 클라이언트와 서버가 특정 포트를 통해 양방향 통신을 하는 방식
- 데이터 전달 후 연결이 끊어지는 것이 아니라 계속해서 연결을 유지 → HTTP에 비해 더 많은 리소스 소모
- 클라이언트와 서버가 실시간으로 계속하여 데이터를 주고받아야하는 경우에 유리
- 실시간 동영상 스트리밍이나 온라인 게임 등에 사용

---

# 캐싱이란

**캐싱(Caching**)은 애플리케이션의 처리 속도를 높여준다. 

이미 가져온 데이터나 계산된 결과값의 복사본을 저장함으로써 처리 속도를 향상시키며, 이를 통해 향후 요청을 더 빠르게 처리할 수 있다. 대부분의 프로그램이 동일한 데이터나 명령어에 반복해서 엑세스하기 때문에 캐싱은 효율적인 아키텍처 패턴

## **적중과 부적중 (cache hit, cache miss)**

캐시에 요청이 도착했을 때, 그에 **대응하는 사본이 있다면 이를 이용해 요청이 처리 → 캐시 적중(cache hit)** 

대응하는 사본이 없다면 원 서버로 요청이 전달 → **캐시 부적중(cache miss)**

---

# CDN **이란 무엇인가?**

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/68fecc62-03dd-4c1f-8237-3b6226295ac7/e598d495-0c2a-4422-8468-0a7c33e3fc1d/Untitled.png)

데이터 통신 기술이 발달하면서 전 세계적으로 유튜브, 넷플릭스 등 수 많은 데이터들이 전송된다. 이렇게 폭발적으로 증가하는 데이터를 최대한 지연 없이 효율적으로 전달하기 위해 CDN이라는 기술이 등장하게 된다.

**CDN은 Content Delivery Network의 약자로서 지리적인 제약 없이 전 세계 사용자에게 빠르고 안전하게 컨텐츠 전송을 할 수 있는 기술을 말한다. 이를 통해서 컨텐츠의 병목현상을 피할 수 있다.**

## CDN 동작 규칙

1. 최초 요청은 서버로부터 컨텐츠를 가져와 고객에게 전송하며 동시에 CDN 캐싱장비에 저장한다.
2. 최초 요청 이후로의 요청은 CDN 에서 지정하는 해당 컨텐츠 만료 시점까지 캐싱된 컨텐츠를 전송한다.
3. 자주 사용하는 페이지에 한해서 캐싱되며, 해당 컨텐츠 호출이 없을 경우 주기적으로 삭제된다.
4. 서버가 파일을 찾는데 실패하는 경우 CDN 플랫폼의 다른 서버에서 컨텐츠를 찾은다음 엔드유저에게 응답을 전송한다.
5. 컨텐츠를 사용할 수 없거나 오래된 경우 CDN은 향후 요청에 대해 응답할 수 있도록 새로운 컨텐츠를 저장한다.

## CDN 캐싱 방식

### Static Caching

- Origin Server 에 있는 Content를 운영자가 미리 Cache Server에 복사 해두어 사용자가 Cache Server에 Content 요청 시 무조건 Cache Server에 있다
- 대부분의 국내 CDN에서 이 방식을 사용 (게임 클라이언트 다운로드 등)

### Dynamic Caching

- Origin Server에 있는 Content를 운영자가 미리 Cache Server에 복사하지 않음
- 사용자가 Content를 요청 시 해당 Content가 없는 경우 Origin Server로부터 다운로드 받아 전달한다. 있는 경우에는 캐싱된 Content전달
- 각각의 Content는 일정 시간 이후 Cache Server에서 삭제 될 수도 있다.

---

# 웹캐시

**웹 캐쉬**란 client가 요청하는 html, image, js, css등에 대해 첫 요청 시에 파일을 내려받아 **특정 위치에 복사본을 저장**하고, 이후 동일한 URL의 Resource요청은 다시 내려 받지 않고 내부에 저장한 파일을 사용하여 더 빠르게 서비스

서버를 통해 내려 받는 양이 적어지니 **응답 시간이 감소**하고 **네트워크 트레픽이 감소**되니 **server**와 **client** 모두가 **win-win!!**

웹 캐쉬의 종류웹 캐쉬의 종류는 어디에 적용하느냐에 따라 다음과 같이 나뉠 수 있으며 이중 중점적으로 볼 내용은 **Browser Cache!!!**

### 1. Browser Caches

- 브라우저 또는 HTTP요청을 하는 Client Application에 의해 내부 디스크에 캐쉬
- Cache된 Resource를 공유하지 않는 한 개인에 한정된 Cache- 브라우저의 Back버튼 또는 이미 방문한 페이지를 재 방문하는 경우 극대화

### 2. Proxy Caches

- Browser Cache와 동일한 원리로 동작하며 Client나 Server가아닌 네트워크 상에서 동작
- 큰 회사나 IPS의 방화벽에 설치 되며 대기시간 & 트래픽 감소, 접근정책 & 제한 우회, 사용률 기록등 수행
- 한정된 수의 클라이언트을 위하여 무한대의 웹서버의 컨텐츠를 캐쉬

### 3. Gateway Caches (REVERSE OR SURROGATE PROXY)

- 서버 앞 단에 설치되어 요청에 대한 캐쉬 및 효율적인 분배를 통해 가용성, 신뢰성, 성능등을 향상
- Encryption / SSL acceleration, Load balancing, Serve/cache static content, Compression등을 수행
- 무한대의 클라이언트들에게 한정된 수(또는 하나)의 웹서버 컨텐츠를 제공

## **웹 캐시의 장점**

1. 불필요한 네트워크 통신을 줄인다.

2. 네트워크 병목을 줄여준다.

3. 거리로 인한 네트워크 지연을 줄여준다.

4. 갑작스런 요청 쇄도(Flash Crowds)에 대처 가능하다.